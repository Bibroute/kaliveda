# KaliVeda documentation & website updates #

This document is written in Markdown.
If you want, you can generate a PDF version using

~~~~~
$ pandoc --toc -o README.pdf README
~~~~~

or if you prefer HTML:

~~~~~
$ pandoc -s --toc -o README.html README
~~~~~

It is of course also readable as a plain text file.

## Updating local versions of documentation ##

### Updating website main pages ###

This will setup/update the main website pages and also the LyX-based
doc pages:

~~~~~~
$ make main_site [prefix=]
~~~~~~

prefix = /some/path
The website docs will be created in $prefix/KaliVedaDoc.
By default, prefix=the current working directory. Make sure you give an
absolute path if you want to change prefix.

### Updating Users Guide ###

~~~~~~
$ make users_guide [prefix=]
~~~~~~

This will recompile the Users Guide if necessary, it will also update the
ClassRefIndex.html page with links to the different versions of class
documentation and links to the chapters of the users guide.

## Uploading updated website pages & documentation ##

### Uploading website main pages ###

Upload the main html pages plus the LyX-based html doc.
If the website is empty (no previous installation), do

~~~~~~
$ make upload_main_site
~~~~~~

To update the existing website, do

~~~~~~
$ make update_main_site
~~~~~~

You will be asked to enter the webserver password.

### Uploading Users Guide ###

If no Users Guide pages exist on website:

~~~~~~
$ make upload_users_guide
~~~~~~

To update existing Users Guide (including adding new chapters):

~~~~~~
$ make update_users_guide
~~~~~~

You will be asked to enter the webserver password.

### Updating all local files ###

The command

~~~~~~
$ make update_all [DOC_TYPE=] [prefix=]
~~~~~~

is equivalent to typing the following commands:

~~~~~~
$ make main_site [prefix=]
$ make users_guide [prefix=]
~~~~~~

### Uploading all updated website files ###

The command

~~~~~~
$ make upload_all
~~~~~~

is equivalent to typing the following commands:

~~~~~~
$ make update_main_site 
$ make update_users_guide
~~~~~~

### Updating and uploading all files ###

The command

~~~~~~
$ make update_and_upload_all [DOC_TYPE=] [prefix=]
~~~~~~

is equivalent to typing the following commands:

~~~~~~
$ make update_all [DOC_TYPE=] [prefix=]
$ make upload_all
~~~~~~

## Adding a Lyx-generated doc module ##

* In the LyXGenDoc source directory, add a directory TOTO.
* Put in TOTO the TOTO.lyx file and any image files used by your doc.
* Copy a Makefile from one of the existing modules into TOTO.
* Add TOTO to the list of MODULES in LyXGenDoc/Makefile

The next time you run

~~~~~~
$ make main_site [prefix=]
~~~~~~

from the top-level directory, TOTO.html will be created in
$prefix/KaliVedaDoc/TOTODoc

Don't forget to declare your new module to bazaar VCS (be careful not to do
`$ bzr add TOTO` after having compiled your module, otherwise not only the source
files but also all files/directories generated by the compilation will be
added to version control, which is *not* what we want):

~~~~~~
$ bzr add LyXGenDoc/TOTO/TOTO.lyx LyXGenDoc/TOTO/*.png LyXGenDoc/TOTO/*.pdf [etc.]
$ bzr commit -m "[explain here what is your new module etc. etc.]"
~~~~~~

## Adding a chapter to the Users Guide ##

The Users Guide is written using Markdown and
[pandoc](http://johnmacfarlane.net/pandoc/README.html). Each chapter has
a single source file in the usersguide/ directory with extension '.txt'.
To add a chapter, write your text in a file usersguide/toto.txt.
The file should begin with the following lines:

~~~~~~
% KaliVeda User's Guide
    
# Chapter title #
~~~~~~

with the title of your chapter between '#'. This way, your chapter title
will automatically be added to the list on page ClassRefIndex.html the next
time you [update the Users Guide][Updating Users Guide].

Don't forget to declare your new chapter to bazaar VCS:

~~~~~~
$ bzr add usersguide/toto.txt
$ bzr commit -m "[explain here what is your new chapter etc. etc.]"
~~~~~~
