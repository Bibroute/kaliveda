<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>Building and installing KaliVeda</title>
    <link rel="stylesheet" href="css/site.css" type="text/css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="images/favicon.ico"
      type="image/x-icon">
    <meta content="J.D. Frankland" name="author">
  </head>
  <body>
    <h1>Building and installing KaliVeda<br>
    </h1>
    <div class="leftSide">
      <div class="KaliVeda">KaliVeda</div>
      <img style="margin-left: 1px; margin-top: 1px; width: 110px;
        height: 100px;" alt="indra"
        src="images/indra_huguet_210x210.png"><br>
      <script language="javascript" src="js/nav.js"></script>
      <br>
      <!-- SiteSearch Google -->
      <form method="get" action="http://www.google.com/search"><input
          name="ie" value="UTF-8" type="hidden"> <input name="oe"
          value="UTF-8" type="hidden"><input name="q" style="margin-top:
          5px;" size="13" maxlength="255" value="" type="text"> <input
          name="btnG" style="margin-top: 5px;" value="Search site"
          onclick="send_data(this.form)" type="submit"></form>
      <!-- SiteSearch Google -->
    </div>
    <div class="page">
      <br>
      <br>
      <h2 class="newsTitle">Installation instructions<br>
      </h2>
      You can find these instructions in the INSTALL file in the
      top-level directory of the source tree.<br>
      <br>
      <br>
      <h3>0. Prerequisites</h3>
      It is assumed that you have a correctly installed and fully
      functioning version of <a href="http://root.cern.ch">ROOT</a>.<br>
      Most notably, we assume that the ROOTSYS environment variable is
      positioned and contains the path to<br>
      the top-level directory of your ROOT installation, and that the
      $ROOTSYS/lib and $ROOTSYS/bin directories<br>
      are included in the system search paths for shared libraries and
      executables, respectively.<br>
      See below (<a href="#no_rootsys">2.1</a>) if ROOT is installed but
      ROOTSYS is not defined on your system.<br>
      <br>
      <h4>0.1 Prerequisites for bazaar branch builds</h4>
      If you obtain the sources as a bazaar branch from <a
        href="https://launchpad.net/kaliveda">Launchpad</a>, you must
      have all GNU build tools installed:<br>
      automake, autoconf, autoreconf, libtool, etc. etc.<br>
      <br>
      <br>
      <br>
      <h3>1. Setting the installation location (KVROOT)</h3>
      The environment variable KVROOT must be defined by the user.<br>
      It must contain the full path to the directory in which you wish
      to install KaliVeda.<br>
      This directory must exist before installation begins.<br>
      <blockquote><b>We strongly recommend that you keep source and
          installation directories SEPARATE,</b><b><br>
        </b><b>in other words: DON'T MAKE KVROOT POINT INSIDE THE SOURCE
          TREE!</b><b><br>
        </b></blockquote>
      KVROOT is needed both during installation, and every time that
      KaliVeda libraries etc. are used.<br>
      Therfore it is best to define this variable in a script which is
      automatically executed at login<br>
      (.bash_profile, .cshrc, etc. etc.)<br>
      <br>
      You must also add the following directories to the
      system-dependent search paths for executables<br>
      and shared libraries (the exact procedure will depend on your
      operating system):<br>
      <br>
      &nbsp;&nbsp;&nbsp; add the directory "$KVROOT/bin" to "PATH" (or
      equivalent executable search path)<br>
      &nbsp;&nbsp;&nbsp; add the directory "$KVROOT/lib" to
      "LD_LIBRARY_PATH" (or equivalent shared library search path)<br>
      <br>
      e.g. on a Linux C-shell system:<br>
      <br>
      &nbsp;&nbsp;&nbsp; setenv LD_LIBRARY_PATH
      ${KVROOT}/lib:${LD_LIBRARY_PATH}<br>
      &nbsp;&nbsp;&nbsp; setenv PATH ${KVROOT}/bin:${PATH}<br>
      <br>
      <blockquote><i><b>N.B.</b> Definition and handling of KVROOT,
          PATH, LD_LIBRARY_PATH can be done using the<br>
          included SetKaliVedaVersion script. See <a
            href="appli.html#SetKaliVedaVersion_version_name_path">here</a>.<br>
        </i></blockquote>
      &nbsp;&nbsp;&nbsp; <br>
      <br>
      <h3>2. Building and installing</h3>
      If you obtained the source tree in the form of a compressed
      archive (tarball or ".tgz"), you must<br>
      first of all type the following command in the top-level
      directory:<br>
      <br>
      &nbsp;&nbsp;&nbsp; <font face="monospace">make unpack</font><br>
      <br>
      In order to compile and install all libraries and executables,
      type the following command in<br>
      the top-level directory of the source tree:<br>
      <br>
      &nbsp;&nbsp;&nbsp; <font face="monospace">make</font><br>
      &nbsp;&nbsp;&nbsp; <br>
      <blockquote>
        <h4>2.1 If ROOTSYS is not defined OR if ROOT is installed in
          e.g. /usr/local/bin<a name="no_rootsys"></a></h4>
        If your installation of ROOT is NOT in a single directory (maybe
        ROOTSYS is not defined), then you need to<br>
        give the path to the ROOT makefile called "Makefile.arch" in
        order to build KaliVeda.<br>
        In most normal ROOT installations, this file is in $ROOTSYS/test
        (for ROOT upto v5.30) or in $ROOTSYS/etc (from v5.32 onwards).<br>
        For example, if the ROOT executables are installed in <font
          face="monospace">/usr/local/bin</font>, and the ROOT libraries
        in <font face="monospace">/usr/local/lib/root</font>,<br>
        then Makefile.arch may be in<font face="monospace">
          /usr/local/share/root/etc</font> (the exact location depends
        on the version of ROOT.<br>
        If this is not the right directory, you will have to search for
        it), in which case you should type:<br>
        <br>
        &nbsp;&nbsp; <font face="monospace">make
          ROOT_MAKEFILE_PATH=/usr/local/share/root/etc</font><br>
        <h4>&nbsp;&nbsp; </h4>
      </blockquote>
      <h4>2.2 Debug build</h4>
      If you want to compile KaliVeda with the maximum of debugging
      information (to use with e.g. gdb), then type:<br>
      <br>
      &nbsp;&nbsp; <font face="monospace">make debug=yes</font><br>
      &nbsp;&nbsp; <br>
      <br>
      <br>
      <h3>3 Optional extras</h3>
      You can find a full list of the Makefile targets <a
        href="#Makefile_targets">here</a>.<br>
      <br>
      <h4>&nbsp; 3.1 Building GANIL acquisition library with Xrootd
        support</h4>
      &nbsp;&nbsp; In order to read raw GANIL acquisition data over the
      network using Xrootd, type:<br>
      &nbsp;&nbsp; <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font face="monospace">make
        MAKE_GANTAPE_XRD=yes</font><br>
      <br>
      &nbsp;&nbsp; For ROOT version 5.32 and later, <i>xrootd</i> is no
      longer installed as a ROOT package,<br>
      &nbsp;&nbsp; but as an external package. In this case, the XRDSYS
      variable must be defined<br>
      &nbsp;&nbsp; and contain the path to the <i>xrootd</i>
      installation. <br>
      <br>
      <h4>&nbsp; 3.2 Use interface to Ricardo Yanez's 'Range' dE/dx and
        range library</h4>
      &nbsp;&nbsp; The default <i>KVedaLoss</i> range and energy loss
      classes are limited to a restricted<br>
      &nbsp;&nbsp; list of "known" materials. If you want to calculate
      energy losses etc. for<br>
      &nbsp;&nbsp; materials which are not included in <i>KVedaLoss</i>,
      you need to install Ricardo Yanez's<br>
      &nbsp;&nbsp; 'Range' library, which is available here: <a
        href="http://www.calel.org/range.html">http://www.calel.org/range.html</a><br>
      &nbsp;&nbsp; <br>
      &nbsp;&nbsp; To build the KaliVeda interface classes to 'Range',
      you need to give the path<br>
      &nbsp;&nbsp; to the installation directory:<br>
      &nbsp;&nbsp; <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font face="monospace">make
        WITH_RANGE_YANEZ=yes RANGE_YANEZ_DIR=$HOME</font><br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>
      &nbsp;&nbsp; In this example, the library is installed in the
      $HOME directory: in this case,<br>
      &nbsp;&nbsp; the files <font face="monospace">$HOME/include/range.h</font>
      and <font face="monospace">$HOME/lib/librange.so</font> must
      exist.<br>
      <h3><br>
      </h3>
      <h4>&nbsp;&nbsp; 3.3 Installing documentation</h4>
      &nbsp;&nbsp; If you want to install a local copy of the KaliVeda
      web site, including the full documentation of all classes,<br>
      &nbsp;&nbsp; type the following command in the top-level directory
      of the KaliVeda sources:<br>
      <br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font face="monospace">make
        doc</font><br>
      <br>
      &nbsp;&nbsp; Open the file <font face="monospace">$KVROOT/KaliVedaDoc/KaliVeda.html</font>
      in a web browser.<br>
      <br>
      <br>
      &nbsp;&nbsp;&nbsp; <br>
      <h3>4. Configuration</h3>
      Many aspects of the KaliVeda environment (such as the location of
      the data repository you use for data<br>
      reduction and analysis) can be configured by creating and editing
      the file <font face="monospace">$HOME/.kvrootrc</font>.<br>
      See the comments &amp; examples in the file <font
        face="monospace">$KVROOT/KVFiles/.kvrootrc</font> (do not copy
      this file in to your<br>
      $HOME directory!), or look <a
        href="http://indra.in2p3.fr/KaliVedaDoc/kvrootrc.html">here</a>
      for more information.<br>
      &nbsp;&nbsp;&nbsp; <br>
      <br>
      <h3>5. Loading KaliVeda libraries in an interactive ROOT session</h3>
      All libraries are installed into the directory "$KVROOT/lib". Thus
      for example, to load the KVMultiDet library,<br>
      type the following instruction (which should be valid for any
      operating system, assuming that the system-<br>
      dependent search path for shared libraries includes $KVROOT/lib;
      see #1 above):<br>
      <br>
      &nbsp;&nbsp;&nbsp;<font face="monospace"> root[0]&nbsp;
        gSystem-&gt;Load("libKVMultiDet")</font><br>
      &nbsp;&nbsp;&nbsp; <br>
      Then to initialise the system (in order for example to compile
      your own code which depends on<br>
      the KaliVeda libraries) type:<br>
      <font face="monospace"><br>
        &nbsp;&nbsp;&nbsp; root[1]&nbsp; KVBase::InitEnvironment()</font><br>
      &nbsp;&nbsp;&nbsp; <br>
      If the ROOT automatic library loading mechanism (rlibmap)
      functions correctly on your system,<br>
      it is only necessary to type <font face="monospace">KVBase::InitEnvironment()</font>
      at the ROOT prompt in order to load and initialise the libraries.<br>
      In fact, in this case, you can directly use KaliVeda classes in
      your interactive session, the libraries<br>
      will be loaded and initialised when needed.<br>
      <br>
      <br>
      <h3>6. Building with KaliVeda libraries outside of ROOT
        interactive session</h3>
      Assuming a GNU/Linux system with gcc, here is how to compile your
      code using KaliVeda &amp; ROOT:<br>
      <br>
      &nbsp;&nbsp;&nbsp; g++ `root-config --cflags` -I$KVROOT/include
      MYCODE.CXX -L$KVROOT/lib -lKVMultiDet `root-config --glibs`<br>
      &nbsp;&nbsp;&nbsp; <br>
      If your code uses classes which are not part of the main
      libKVMultiDet.so library (see class doc to know<br>
      to which library each class belongs), you should add them as
      follows:<br>
      <br>
      &nbsp;&nbsp;&nbsp; g++ `root-config --cflags` -I$KVROOT/include
      MYCODE.CXX -L$KVROOT/lib -lKVIndra -lKVMultiDet `root-config
      --glibs`<br>
      &nbsp;&nbsp;&nbsp; g++ `root-config --cflags` -I$KVROOT/include
      MYCODE.CXX -L$KVROOT/lib -lVAMOS -lKVIndra -lKVMultiDet
      `root-config --glibs`<br>
      <br>
      <br>
      <br>
      <br>
      <h3>
      </h3>
      <h2 class="newsTitle"><a name="Makefile_targets"></a>Makefile
        targets</h2>
      <br>
      <span style="font-weight: bold;"><span style="font-family:
          helvetica,arial,sans-serif;"><font style="font-weight: bold;"
            size="+1"><span style="font-family:
              helvetica,arial,sans-serif;">make</span></font><br>
        </span></span><span style="font-family:
        helvetica,arial,sans-serif;">Build
        all
        libraries and applications and install them in the location
        given
        by environment variable $KVROOT. No need for 'make install'
        afterwards.
        Several options can be given to control the build:<br>
        <br>
      </span>
      <div style="margin-left: 80px;"><span style="font-family:
          helvetica,arial,sans-serif;"><font size="+1"><span
              style="font-weight: bold; font-family:
              helvetica,arial,sans-serif;">make
            </span><span style="font-style: italic; font-weight: bold;
              font-family: helvetica,arial,sans-serif;">[option1]
              [option2]
              [option3]</span><span style="font-weight: bold;
              font-family: helvetica,arial,sans-serif;">
              ...</span></font></span><br>
        <span style="font-family: helvetica,arial,sans-serif;">
        </span><br>
        <span style="font-family: helvetica,arial,sans-serif;"><span
            style="font-weight: bold;"><span style="font-family:
              helvetica,arial,sans-serif;">
              <span style="font-weight: bold;">[option] debug=yes</span></span><br>
          </span><span style="font-family: helvetica,arial,sans-serif;">
            Will compile all sources with no optimisation and extra
            debugging
            information for the GNU
            debugger, "gdb</span>"<span style="font-weight: bold;"><br>
            <span style="font-family: helvetica,arial,sans-serif;">
            </span><br>
            <span style="font-family: helvetica,arial,sans-serif;">
              <span style="font-weight: bold;"></span></span></span></span><span
          style="font-family: helvetica,arial,sans-serif;"><span
            style="font-weight: bold;"><span style="font-family:
              helvetica,arial,sans-serif;"><span style="font-weight:
                bold;"><span style="font-family:
                  helvetica,arial,sans-serif;"><span style="font-weight:
                    bold;">[option] memcheck=yes</span></span><br>
              </span></span></span><span style="font-family:
            helvetica,arial,sans-serif;"><span style="font-family:
              helvetica,arial,sans-serif;">
              Will compile all sources with no optimisation, no inlines
              and extra
              debugging information for use with "valgrind" memory-leak
              checking tool</span></span><span style="font-weight:
            bold;"><span style="font-family:
              helvetica,arial,sans-serif;"><span style="font-weight:
                bold;"><br>
                <span style="font-family: helvetica,arial,sans-serif;">
                </span><br>
                <span style="font-family: helvetica,arial,sans-serif;">
                  <span style="font-weight: bold;"></span></span></span></span></span></span><span
          style="font-family: helvetica,arial,sans-serif;"><span
            style="font-weight: bold;">[option]
            ROOT_MAKEFILE_PATH=[path]</span></span><br>
        <span style="font-family: helvetica,arial,sans-serif;">
          Required if ROOTSYS is not defined e.g. when ROOT is installed
          in
          standard system directories such as /usr/local/bin,
          /usr/local/lib/root, etc. In this case we cannot find the ROOT
          Makefile
          which sets compiler options for different machine
          architectures,
          $ROOTSYS/test/Makefile.arch.</span><br>
        <span style="font-family: helvetica,arial,sans-serif;">
          Give the full path of the directory containing this file on
          your
          system, e.g.</span><br>
        <span style="font-family: helvetica,arial,sans-serif;">
        </span></div>
      <div style="text-align: left; margin-left: 120px;"><span
          style="color: rgb(0, 0, 0); font-family: monospace;">make
          ROOT_MAKEFILE_PATH=/usr/local/share/root/test</span><br>
      </div>
      <div style="margin-left: 40px;">
        <div style="margin-left: 40px;"><br>
          <span style="font-weight: bold;">[option] MAKE_GANTAPE_XRD=yes</span><br>
          Will build GANIL acquisition library libgan_tape.so with
          Xrootd support
          enabled. This makes it possible to read raw data files via an
          Xrootd
          server.<br>
          <br>
          <span style="font-weight: bold;">[option]
            MAKE_GANTAPE_RFIO=yes</span><br>
          Will build GANIL acquisition library libgan_tape.so with RFIO
          support
          enabled. This
          makes it possible to read raw data files via an RFIO server.<span
            style="font-family: helvetica,arial,sans-serif;"></span><br>
        </div>
        <span style="font-family: helvetica,arial,sans-serif;"></span></div>
      <span style="font-weight: bold;"><span style="font-family:
          helvetica,arial,sans-serif;"><br>
          <font style="font-weight: bold;" size="+1"><span
              style="font-family: helvetica,arial,sans-serif;"></span></font></span></span><span
        style="font-weight: bold;"><span style="font-family:
          helvetica,arial,sans-serif;"><span style="font-weight: bold;"><span
              style="font-family: helvetica,arial,sans-serif;"><font
                style="font-weight: bold;" size="+1"><span
                  style="font-family: helvetica,arial,sans-serif;">make
                  unpack</span></font><br>
            </span></span></span></span><span style="font-family:
        helvetica,arial,sans-serif;"><span style="font-family:
          helvetica,arial,sans-serif;">
          Required when building from sources acquired as a '.tgz'
          distribution.
          The subdirectories in the main source directory are also in
          '.tgz'
          files. This command unpacks them ready for the build process,
          e.g. to
          build and install from a '.tgz', do<br>
        </span></span>
      <div style="color: rgb(0, 0, 0); text-align: left; margin-left:
        40px; font-family: monospace;">make
        unpack<br>
      </div>
      <div style="color: rgb(0, 0, 0); text-align: left; margin-left:
        40px;"><span style="font-family: monospace;">make</span><br>
        <span style="font-family: helvetica,arial,sans-serif;"><span
            style="font-family: helvetica,arial,sans-serif;"></span></span></div>
      <span style="font-family: helvetica,arial,sans-serif; color:
        rgb(0, 0, 0);"><span style="font-family:
          helvetica,arial,sans-serif;">
        </span></span><span style="font-weight: bold;"><span
          style="font-family: helvetica,arial,sans-serif;"><span
            style="font-weight: bold;"><span style="font-family:
              helvetica,arial,sans-serif;"><br>
              <font style="font-weight: bold;" size="+1"><span
                  style="font-family: helvetica,arial,sans-serif;"></span></font></span></span></span></span><font
        style="font-weight: bold;" size="+1"><span style="font-family:
          helvetica,arial,sans-serif;">make doc</span></font><br>
      After building the libraries &amp; applications, you can generate
      the
      full HTML documentation (actually a local copy of this website)
      using
      this target. The home page will be located at
      $KVROOT/KaliVedaDoc/index.html<br>
      <br>
      <div style="text-align: left; font-family:
        helvetica,arial,sans-serif; font-weight: bold;"><font size="+1">make
          dist<br>
        </font></div>
      Cleans the source tree, then bundles together the sources to
      create a
      '.tgz' distribution file.<br>
      <br>
      <font style="font-weight: bold;" size="+1"><span
          style="font-family: helvetica,arial,sans-serif;">make clean</span></font><br>
      Clears the source tree of all files resulting from any previous
      build.
      Needed in order to recompile the whole project from scratch, in
      case of
      problems with a previous build. Can also be useful if previously
      compiled sources are updated using bazaar.<br>
      <br>
      <font style="font-weight: bold;" size="+1"><span
          style="font-family: helvetica,arial,sans-serif;">make
          distclean</span></font><br>
      As 'make clean', but also removes files which can cause problems
      between different versions of KaliVeda (such as the
      $KVROOT/KVFiles/*/DataBase.root files, and
      ~/.KVDataAnalysisGUIrc).<br>
      <br>
      <font style="font-weight: bold;" size="+1"><span
          style="font-family: helvetica,arial,sans-serif;">make
          uninstall</span></font><br>
      Will remove all trace of KaliVeda libraries, applications, files
      &amp;
      directories from the $KVROOT directory. Does not remove the
      directory
      itself (good news if you set KVROOT to $HOME!)<font
        style="font-weight: bold;" size="+1"><span style="font-family:
          helvetica,arial,sans-serif;"><br>
        </span></font>
      <div class="download"><br>
        <ol>
        </ol>
      </div>
      <p class="copyright">Web design based on www.xmms.org - Hope you
        don't
        mind! Thankyou! <br>
      </p>
    </div>
  </body>
</html>
